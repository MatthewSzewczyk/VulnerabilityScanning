<h1>Vulnerability Scanning with OpenVAS</h1>



<h2>Description</h2>
For this project, I aimed to demonstrate my proficiency in conducting vulnerability assessments and effectively addressing identified vulnerabilities within a deliberately vulnerable Windows 10 system. The project involved executing both non-credentialed and credentialed scans before undertaking remediation actions, followed by another credentialed scan post-remediation for comparative analysis.
<br />
<br />
I meticulously detailed the process of intentionally making a Windows 10 virtual machine susceptible to vulnerabilities. Additionally, I outlined the setup and configuration steps involved in preparing a dedicated OpenVAS VM and configuring both the OpenVAS and Windows 10 VMs to facilitate credentialed scans.
<br />


<h2>Languages and Utilities Used</h2>

- <b>OpenVAS</b> 

<h2>Environments Used </h2>

- <b>Windows 10</b>
- <b>Microsft Azure</b>

<h2>Project walk-through</h2>

<p align="center">
Before commencing the project, I began by provisioning an OpenVAS VM and a Windows 10 VM on the Microsoft Azure cloud platform, ensuring both were deployed on the same virtual network. After successfully creating the VMs, I initiated a remote desktop connection from my personal Windows computer to access and configure the Windows 10 VM. Once connected,  I accessed the Windows Defender Firewall settings and disabled several options to enhance the VM's vulnerability for testing purposes: <br/>
<img src="https://i.imgur.com/wb7f6Ln.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
Within Windows Defender Firewall I selected the properties option and turned off the domain, private, and public profiles:  <br/>
<img src="https://i.imgur.com/TSOSsJm.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
Next I went an installed depreciated versions of Adobe, Firefox, and VLC Player which will all scan as vulnerable. After installing all three I reset the Windows 10 VM: <br/>
<img src="https://i.imgur.com/afsHF4v.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
Next, I accessed the OpenVAS web application on my physical PC and signed into the OpenVAS virtual machine, which is on the same network as my Windows 10 virtual machine. Once logged into OpenVAS, I needed to configure it to perform an initial scan, targeting the vulnerable Windows 10 VM with an uncredentialed scan. This type of scan will assess the Windows 10 VM at a superficial level, without attempting to log into the VM, effectively simulating an external viewpoint:  <br/>
<img src="https://i.imgur.com/gBpNQu9.png" height="90%" width="90%" alt="Vuln Project"/>
<br />
<br />
To start this process, I had to add the Windows VM to OpenVAS’s assets. This was done by going to the assets tab > selecting hosts > New Host (top left corner) and then in that window I entered in the Private IP address designated for Windows 10 VM. Once created, the new asset will show up on the screen: <br/>
<img src="https://i.imgur.com/OeQyI1S.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/oodbPmj.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
I then selected “Create Target From Host” under the actions section of the new asset and Entered the name and comment as shown and then selected save:  <br/>
<img src="https://i.imgur.com/J2D8O76.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/Z77kpwx.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
Next, I selected the Scans tab > Tasks > New Task (top left). Within the New Task window, I entered the Name, Comment, and selected the previously created host for the Scan Targets drop down. Leaving the rest to default and saving:  <br/>
<img src="https://i.imgur.com/Ib0Scr7.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
Once the task was saved I then started the scan by selecting the play button:  <br/>
<img src="https://i.imgur.com/4MbqzuX.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
Upon completion of the scan, I selected "Last Report" under the Scan Vuln VM UA task to review the detailed scan report. Given that this was an uncredentialed scan, OpenVAS could only perform an external assessment. Consequently, the scan was limited to detecting open ports, service versions, operating system identification, and configuration issues, while it was unable to inspect the vulnerable applications installed on the VM. 
<br />The results tab shows 3 medium/low vulnerabilities that could be remediated while the many others are just for informative purposes. The other tabs are mostly information about the host but can provide a good insight on what configurations could be changed to harden the systems defensive posture, for an example open ports that should be closed:  <br/>
<img src="https://i.imgur.com/kswxUa6.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/gbGa6iN.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
After analyzing the results of the uncredentialed scan, I reconnected to the Windows 10 VM. Once connected, I configured the settings to facilitate an authenticated scan. This included enabling remote user access and granting them the ability to manage the Windows registry located on the Windows VM. Which was done by going to Services > Remote Registry > Startup Type > Automatic > Apply > Start:  <br/>
<img src="https://i.imgur.com/0hxosVj.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
Next, I modified one of the windows registries setting to allow remote administration of the VM using administrative credentials without requiring those credentials to be explicitly passed to User Account Control (UAC) on the VM. This was done by going to  Regedit.exe > HKEY_LOCAL_MACHINE > SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System key and then Create a new DWORD (32-bit) value with the following properties:  Name: LocalAccountTokenFilterPolicy and then change its value to 1. Once done I then reset the VM:  <br/>
<img src="https://i.imgur.com/vkp0dXz.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/9vbk15u.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/PLlt4Ng.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/69hnhxO.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
Next, I went back into the OpenVAS web app to configure it to perform credentialed scans on the Windows VM. Starting with creating authentication credentials that can be used for the authenticated scans. This was done by going to the Configurations tab > Credentials > New Credential (top left). Then filling out the page as follows:  <br/>
<img src="https://i.imgur.com/2HcEoVm.png" height="80%" width="90%" alt="AD project"/>
<br />
<br />
Next, I went to Configurations > Target and cloned the target I made earlier. Then I edited the clone changing the Name, Comment, and then selected the SMB dropdown and selected the name of the credentials I just made, enabling Credentialed scans on the target:  <br/>
<img src="https://i.imgur.com/ld1P0KP.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/h181UZc.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/6demAV8.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
Next, I navigated over to Tasks and cloned the tasked I made earlier. Then I edited the cloned task changing the Name, Comment, and Scan Targets to the credentialed target I just made. After saving I then ran the credentialed scan on the Windows VM:  <br/>
<img src="https://i.imgur.com/enTeVQO.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/Cmfn1h6.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
Once the scan was completed, I could see that the credentialed scan was able to detect much higher severity vulnerabilities when compared to the uncredentialed scan:  <br/>
<img src="https://i.imgur.com/UslXTFX.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
After selecting the report, I observed numerous high and medium severity vulnerabilities associated with the three deprecated programs I had installed. If I were unaware of these installations, the scan results would clearly indicate that removing or updating these programs would effectively remediate the identified vulnerabilities:  <br/>
<img src="https://i.imgur.com/3KanJut.png" height="80%" width="80%" alt="Vuln Project"/>
<br />
<br />
After analyzing the results of the scan I went back into the Windows 10 VM and uninstalled the 3 programs and restarted the VM:  <br/>
<img src="https://i.imgur.com/No0VLRi.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/mSNVFqp.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
<br />
I then preformed another credentialed scan to compare the differences in vulnerabilities after remediation. Reviewing the second credentialed scan with the vulnerable programs removed I could see that only two vulnerabilities remained that were not detected during the uncredentialed scan. After further analysis of these two new vulnerabilites i.e. IExpress and HID fuctionality, I determined that they were false positives since they were not applicable to this system and could not be exploited. Thus, concluding this project:  <br/>
<img src="https://i.imgur.com/Ci9PicH.png" height="80%" width="90%" alt="Vuln Project"/>
<img src="https://i.imgur.com/0uPq6zp.png" height="80%" width="90%" alt="Vuln Project"/>
<br />
</p>
